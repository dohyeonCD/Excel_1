@ 데이터 디지털 변환 @
DB화! (데이터 구조화 하기)
out-put image, 데이터 명세서, 실제데이터, 추가 설명(담당 업무 프로세스) --> 필요함. 분석의 기초.



@ 폴더의 파일 결합 2 @
(하위 폴더도 있고, 이상한 파일도 있고, 시트 이름도 여러개~)
1. 리본 데이터 '새 쿼리'-> 파일에서-> 폴더에서-> 폴더 경로 지정(폴더 안으로 더 들어가면 안됨)-> '편집'
2-1. 파워쿼리 쿼리창에서 Folder path -> 결합하려는 폴더가 아닌 것들 체크 제외
  -2. 쿼리창에서 Extension -> 엑셀 형식이 아닌 것들 체크 제외
3. 쿼리창에서 Content-> M.R -> 다른 열 제거-> 컬럼 내 파일 병합 아이콘-> (표시 옵션) 병합할 때 시트 이름 여러개 뜨면~ 폴더 자체 선택-> 확인
4. 쿼리창에서 Data 컬럼만 남겨두고(M.R) 다른 열 제거-> 컬럼 내 확장 아이콘-> '원래 열 이름을 접두사로 사용' 체크 제외 (거의 항상)
5. 중간중간 있는 쓸모없는 행들은 필터로 체크 제외
6. 쿼리 예쁘게 만들고 로드~



@ 시트 통합 @
1. 리본 데이터 '새 쿼리'-> 파일에서-> 통합 문서에서-> (표시 옵션) 병합할 때 시트 이름 여러개 뜨면~ 폴더 자체 선택-> 확인
                                                                                         만약, 일회용인데 다 합칠 필요가 없으면, 여러 항목 선택해서 쓸 시트만 선택~
2. 쿼리창에서 Data 컬럼만 남겨두고(M.R) 다른 열 제거-> 컬럼 내 확장 아이콘-> '원래 열 이름을 접두사로 사용' 체크 제외 (거의 항상)
3. 중간중간 있는 쓸모없는 행들은 필터로 체크 제외(NULL...)
4. 쿼리 예쁘게~



@ 원본 데이터 경로 이동시, 업데이트 @
1. 오류가 난 쿼리 파일 들어가기
2. 리본 홈 '데이터 원본 설정'-> 잘못된 경로 선택-> 원본 변경
3. 리본 홈 미리보기 '미리보기 새로고침'-> 모두 새로 고침 (한글에서는 오류가 날 때가 있음..)



@ 크로스 테이블 @
데이터가 행 방향으로 나열되어 있는 것. (데이터 구조화 예쁘게 안되어있음 ㅠ. 보고서용도로는 바람직,,, 분석용도로는..ㅠ)
-> 열 방향으로 해야 함. (unpivot 시켜야 함)
1. 파워쿼리에서 바꾸고 싶은 컬럼들(밑으로 내릴 컬럼들) 다 선택-> 컬럼 M.R-> '선택한 열만 피벗 해제'
2. 쿼리 수정~~ 수식 넣는 컬럼을 추가하려면 리본 열 추가 메뉴 '사용자 지정 열'  (문자는 무조건 " ")



@ 테이블 결합 @
병합 (Join 개념) : 교집합도 고려해줌. 옆으로 연결
추가 (Union 개념) : 아래로 추가 연결.


# 추가 # 
파워쿼리창 목록-> 원하는 순서에 맞게 기준이 될 쿼리 M.R-> 추가-> 원하는 만큼 추가~


# 병합 #
1. 병합하려는 데이터를 표개체로 만들기.
2. 파워쿼리 리본 홈 메뉴 '닫기 및 로드'에서 닫기 및 다음으로 로드   (닫기 및 로드는 파워쿼리 완성된 것을 새로운 시트로 만든다는 뜻)
    -> 연결만 만들기 (파워쿼리를 인지만 해줘~ 시트로 만들지 말구~ 이따 결합할 거니까~ 용량도 좀 줄이구~)
3. 파워쿼리창 목록-> 원하는 순서에 맞게 기준이 될 쿼리 M.R-> 병합-> Primary key 설정은 기준 컬럼 마우스로 클릭. 여러개 지정 가능
                                                                                              (컬럼 이름은 달라도 데이터 타입이 같아야 함.)
4. 조인 종류 선택-> 확인-> 파워쿼리에서 확장 아이콘-> '원래 열 이름을 접두사로 사용' 체크 제외-> 쿼리 수정~
5. 파워쿼리 리본 홈 메뉴 '닫기 및 로드'에서 닫기 및 다음으로 로드-> '기존 워크시트' 같은 시트 내의 빈 셀 입력(범위 입력)-> 확인


# 조인 종류 #
왼쪽 외부= Left join,      오른쪽 외부= Right join,      
완전 외부= Outer join (리본 열추가 메뉴 '조건 열'-> if느낌. 제품명에서 null 이면 제품명 1 필드(열 선택아이콘으로 바꾸고)참고해서 가져와~ 
                                정상이면 제품명으로 가져와~ 그래서 빈 행 없도록 만들어~)
내부= Inner join, 
왼쪽 엔티= 왼쪽 데이터에서 겹치지 않는 유일한 애들만,                  오른쪽 엔티= 오른쪽 데이터에서 겹치지 않는 유일한 애들만.




@ 실습 (인천데이터) @
파워쿼리에서 못하는 부분은 수동으로 좀 해야 함. (병합되어있는 셀을 다른 셀이랑 따로따로 묶고 싶을 때)
1. 없애려는 행 아래에 행 추가하여 수식 (=병합되어있는 셀&" "&연결하려는 다른 셀) 추가.
2. 값 붙여넣기로 수식 없이 해놓은 다음, 위에서 쓴 셀 지우기.
3. 표개체로 만들고 파워쿼리~
4. 파워쿼리는 값이 아무것도 없는 셀을 null값으로 인지하지 못함-> 인지하도록 시도별 컬럼-> '값 바꾸기'-> 바꿀 항목에 'null'
5. 파워쿼리 시도별 컬럼-> '채우기' (아래로: 있는 값을 기준으로 그 아래를 채움)
6. unpivot 하고, 쿼리 unpivot한 컬럼 년도 분리(공백으로 분할)-> 월별 컬럼과 열 병합(-)-> 날짜 데이터로 변환하여 day까지 나오도록.
7. 시트로 로드~

<<기본분석: 피벗테이블로 집계>>
1. 원본데이터 셀 아무곳-> 리본 삽입 메뉴 '피벗 테이블'-> 확인
2. 피벗테이블 필드에서 날짜 타입의 데이터-> 행(y)으로 드래그 (자동으로 계층화 되어 연도, 분기, 날짜로 나뉘어서 들어감. 필요없는 건 밖으로 버리면 됨)
3. 시도별-> 열(x)로 드래그
4. 값-> 시그마 값으로 드래그 ('값 필드 설정'을 합계로)
5. 행 레이블, 열 레이블 이름을 바꾸고 싶으면 피벗테이블 안에 아무곳-> 피벗테이블 도구 메뉴 디자인 '보고서 레이아웃'-> 테이블 형식
6. 숫자형식 가독성 높이려면 시그마 값의 값 필드 설정에서 '표시 형식' 숫자로~(1000단위 체크)
7. 보고 싶은 컬럼만 선택하려면 시도별 필터에서 선택

<<시각화>>
1. 숫자데이터가 있는 좌측 첫번째 셀-> 리본 홈 메뉴 '조건부 서식' (규칙 관리-> 새 규칙-> 규칙 적용 대상에서 3번째 버튼. 색조 변경~)  '정적 대시보드'
2. 피벗테이블 셀 아무곳-> 피벗 테이블 분석 메뉴 '슬라이서 삽입' (구분해서 보고 싶은 값 선택)
3. 슬라이서-> 리본 슬라이서 메뉴 '열' 값을 조정(ncol느낌)-> 보통 좌측상단으로 옮겨 놓음.
4. 제목 없애려면 슬라이서-> 슬라이서 설정-> 머리글 표시 체크 해제
5. 시계열 차트(꺾은선) 만들기-> 피벗테이블 셀 아무곳-> 피벗 테이블 분석 메뉴 '피벗 차트'-> 차트 유형 선택
6. 쓸데없는 버튼들 없애려면 차트 선택-> 피벗 차트 도구 메뉴 '분석'-> 필드 단추-> 모두 숨기기
7. grid 지우려면 차트 오른쪽 +버트 눌러서 '눈금선' 체크 해제

<<마무리>>
1. 밖에 있는 눈금선 없애려면 리본 보기 메뉴 '눈금선' 체크 해제
2. 리본 페이지 레이아웃 메뉴 '색' 바꿀 수 있음~
3. 시트 이름 바꾸기
